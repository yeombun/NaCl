<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>CM31P 실시간 모니터링</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script>
    async function fetchData() {
      try {
        const response = await fetch("data.json?cache=" + Date.now());
        const data = await response.json();
        document.getElementById("time").innerText = data.timestamp;
        document.getElementById("conc").innerText = data.concentration + " µS/cm";
        document.getElementById("temp").innerText = data.temperature + " °C";

        Plotly.newPlot("concGraph", [{x: [data.timestamp],y: [data.concentration],mode: 'lines+markers',marker: {color: 'blue'}}], {title: "농도 (µS/cm)"});
        Plotly.newPlot("tempGraph", [{x: [data.timestamp],y: [data.temperature],mode: 'lines+markers',marker: {color: 'red'}}], {title: "온도 (°C)"});
      } catch (e) {
        console.error("데이터 로드 실패", e);
      }
    }
    setInterval(fetchData, 5000);
    window.onload = fetchData;
  </script>
</head>
<body>
  <h1>🌡️ CM31P 실시간 모니터링</h1>
  <p><b>시간:</b> <span id="time">-</span></p>
  <p><b>농도:</b> <span id="conc">-</span></p>
  <p><b>온도:</b> <span id="temp">-</span></p>
  <div id="concGraph" style="width:45%;height:400px;display:inline-block;"></div>
  <div id="tempGraph" style="width:45%;height:400px;display:inline-block;"></div>
</body>
</html>
